<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preprocessing data prior to machine learning • mikropml</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Preprocessing data prior to machine learning">
<meta property="og:description" content="mikropml">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mikropml</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Preprocessing data prior to machine learning</h1>
            
      
      
      <div class="hidden name"><code>preprocess.Rmd</code></div>

    </div>

    
    
<p>Before running machine learning, it’s often necessary and prudent to preprocess your input data. We provide a function (<code>preprocess_data</code>) to preprocess input data. The defaults we chose are based on best practices used in <a href="https://gitlab.eecs.umich.edu/mld3/FIDDLE/-/tree/master/">FIDDLE</a>. Feel free to check out FIDDLE for more information about data preprocessing!</p>
<p>The <code>preprocess_data</code> function takes an input dataset where the rows are the samples and the columns are the outcome variable and features. We preprocess the data as follows:</p>
<ul>
<li>Remove missing outcome values.</li>
<li>Leave binary features as-is (except that categorical variables are converted to 0 and 1, and binary variables with missing features are split into two rows - see below for more details).</li>
<li>Normalize continuous features using <code><a href="https://rdrr.io/pkg/caret/man/preProcess.html">caret::preProcess</a></code> based on the method provided.</li>
<li>Convert categorical features with more than 2 categories to 0 and 1 in multiple columns (one for each category, so each category has it’s own column).</li>
<li>Replace missing categorical data with 0.</li>
<li>Impute missing continuous values with the median of the feature.</li>
<li>By default, remove all features with near-zero variance.</li>
<li>By default, collapse correlated features.</li>
</ul>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<p>We’re going to start off simple and get more complicated, but if you want the whole shebang at once, just scroll to the bottom.</p>
<p>First, we have to load <code>mikropml</code>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">mikropml</span>)</pre></body></html></div>
<div id="binary-data" class="section level2">
<h2 class="hasAnchor">
<a href="#binary-data" class="anchor"></a>Binary data</h2>
<p>Let’s start with only binary variables:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="co"># raw binary dataset</span>
<span class="no">bin_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>),
  <span class="kw">var3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>,<span class="st">"a"</span>,<span class="st">"b"</span>))
)
<span class="no">bin_df</span>
<span class="co">#&gt;   outcome var1 var2 var3</span>
<span class="co">#&gt; 1  normal   no    0    a</span>
<span class="co">#&gt; 2  normal  yes    1    a</span>
<span class="co">#&gt; 3  cancer   no    1    b</span></pre></body></html></div>
<p>In addition to the dataframe itself, you have to provide the name of the outcome column to <code>preprocess_data</code>. Here’s what the preprocessed data looks like:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="co"># preprocess raw binary data</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">bin_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   outcome var1_yes var2_1 var3_b</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0      0      0</span>
<span class="co">#&gt; 2 normal         1      1      0</span>
<span class="co">#&gt; 3 cancer         0      1      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>The output is a list of length two: <code>dat_transformed</code> which has the transformed data, and <code>grp_feats</code> which is a list of grouped features. Here, <code>grp_feats</code> is <code>NULL</code> because there are no perfectly correlated features (e.g. <code><a href="https://rdrr.io/r/base/c.html">c(0,1,0)</a></code> and <code><a href="https://rdrr.io/r/base/c.html">c(0,1,0)</a></code>, or <code><a href="https://rdrr.io/r/base/c.html">c(0,1,0)</a></code> and <code><a href="https://rdrr.io/r/base/c.html">c(1,0,1)</a></code> - see below for more details).</p>
<p>The first column (<code>var1</code>) in <code>dat_transformed</code> is a character and is changed to <code>var1_yes</code> that has zeros (no) and ones (yes). The values in the second column (<code>var2</code>) stay the same because it’s already binary, but the name changes to <code>var2_1</code>. The third column (<code>var3</code>) is a factor and is also changed to binary where b is 1 and a is 0, as denoted by the new column name <code>var3_b</code>.</p>
</div>
<div id="categorical-data" class="section level2">
<h2 class="hasAnchor">
<a href="#categorical-data" class="anchor"></a>Categorical data</h2>
<p>On to non-binary categorical data:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># raw categorical dataset</span>
<span class="no">cat_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)
  )
<span class="no">cat_df</span>
<span class="co">#&gt;   outcome var1</span>
<span class="co">#&gt; 1  normal    a</span>
<span class="co">#&gt; 2  normal    b</span>
<span class="co">#&gt; 3  cancer    c</span></pre></body></html></div>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="co"># preprocess raw categorical data</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">cat_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   outcome var1_a var1_b var1_c</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal       1      0      0</span>
<span class="co">#&gt; 2 normal       0      1      0</span>
<span class="co">#&gt; 3 cancer       0      0      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>As you can see, this variable was split into 3 different columns - one for each type (a, b, and c). And again, <code>grp_feats</code> is <code>NULL</code>.</p>
</div>
<div id="continuous-data" class="section level2">
<h2 class="hasAnchor">
<a href="#continuous-data" class="anchor"></a>Continuous data</h2>
<p>Now, looking at continuous variables:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="co"># raw continuous dataset</span>
<span class="no">cont_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>)
  )
<span class="no">cont_df</span>
<span class="co">#&gt;   outcome var1</span>
<span class="co">#&gt; 1  normal    1</span>
<span class="co">#&gt; 2  normal    2</span>
<span class="co">#&gt; 3  cancer    3</span></pre></body></html></div>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="co"># preprocess raw continuous data</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">cont_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   outcome  var1</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal     -1</span>
<span class="co">#&gt; 2 normal      0</span>
<span class="co">#&gt; 3 cancer      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>Wow! Why did the numbers change? This is because the default is to normalize the data using <code><a href="https://rdrr.io/r/base/c.html">c("center","scale")</a></code>. While this is often best practice, you may not want to normalize the data, or you may want to normalize the data in a different way. If you don’t want to normalize the data, you can use <code>method=NULL</code>:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="co"># preprocess raw continuous data, no normalization</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">cont_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="kw">NULL</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   outcome  var1</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal      1</span>
<span class="co">#&gt; 2 normal      2</span>
<span class="co">#&gt; 3 cancer      3</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>You can also normalize the data in different ways. You can implement any method used by the <a href="https://www.rdocumentation.org/packages/caret/versions/6.0-86/topics/preProcess"><code><a href="https://rdrr.io/pkg/caret/man/preProcess.html">caret::preProcess</a></code></a> function (the <code>method</code> argument).</p>
<p>Another feature of the <code>preprocess_data</code> function is that if you provide continuous variables as characters, they will be converted to numeric:</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="co"># raw continuous dataset as characters</span>
<span class="no">cont_char_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>,<span class="st">"2"</span>,<span class="st">"3"</span>)
  )
<span class="no">cont_char_df</span>
<span class="co">#&gt;   outcome var1</span>
<span class="co">#&gt; 1  normal    1</span>
<span class="co">#&gt; 2  normal    2</span>
<span class="co">#&gt; 3  cancer    3</span></pre></body></html></div>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="co"># preprocess raw continuous character data as numeric</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">cont_char_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   outcome  var1</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal     -1</span>
<span class="co">#&gt; 2 normal      0</span>
<span class="co">#&gt; 3 cancer      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>If you don’t want this to happen, and you want character data to remain character data even if it can be converted to numeric, you can use <code>to_numeric=FALSE</code> and they will be kept as categorical:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="co"># preprocess raw continuous character data as characters</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">cont_char_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">to_numeric</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   outcome var1_1 var1_2 var1_3</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal       1      0      0</span>
<span class="co">#&gt; 2 normal       0      1      0</span>
<span class="co">#&gt; 3 cancer       0      0      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>As you can see from this output, in this case the features are treated as groups rather than numbers (e.g. they are not normalized).</p>
</div>
<div id="collapse-perfectly-correlated-features" class="section level2">
<h2 class="hasAnchor">
<a href="#collapse-perfectly-correlated-features" class="anchor"></a>Collapse perfectly correlated features</h2>
<p>By default, the <code>preprocess_data</code> function collapses features that are perfectly positively or negatively correlated. This is because having multiple copies of those feautres does not add information to machine learning, and it makes <code>run_ml</code> faster.</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="co"># raw correlated dataset</span>
<span class="no">corr_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>),
  <span class="kw">var3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span>)
)
<span class="no">corr_df</span>
<span class="co">#&gt;   outcome var1 var2 var3</span>
<span class="co">#&gt; 1  normal   no    0    1</span>
<span class="co">#&gt; 2  normal  yes    1    0</span>
<span class="co">#&gt; 3  cancer   no    0    1</span></pre></body></html></div>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="co"># preprocess raw correlated dataset</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">corr_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   outcome  grp1</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal      0</span>
<span class="co">#&gt; 2 normal      1</span>
<span class="co">#&gt; 3 cancer      0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; $grp_feats$grp1</span>
<span class="co">#&gt; [1] "var2_1"   "var1_yes" "var3_1"</span></pre></body></html></div>
<p>As you can see, we end up with only one variable, as all 3 are grouped together. Also, the second element in the list is no longer <code>NULL</code>. Instead, it tells you that <code>grp1</code> contains <code>var1</code>, <code>var2</code>, and <code>var3</code>.</p>
<p>If you want to group positively correlated features, but not negatively correlated features (e.g. for interpretability, or another downstream application), you can do that by using <code>group_neg_corr=FALSE</code>:</p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="co"># preprocess raw correlated dataset; don't group negatively correlated features</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">corr_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">group_neg_corr</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   outcome var3_1  grp1</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal       1     0</span>
<span class="co">#&gt; 2 normal       0     1</span>
<span class="co">#&gt; 3 cancer       1     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; $grp_feats$var3_1</span>
<span class="co">#&gt; [1] "var3_1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$grp1</span>
<span class="co">#&gt; [1] "var2_1"   "var1_yes"</span></pre></body></html></div>
<p>Here, <code>var3</code> is kept on it’s own because it’s negatively correlated with <code>var1</code> and <code>var2</code>. You can also choose to keep all features separate, even if they are perfectly correlated, by using <code>collapse_corr_feats=FALSE</code>:</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="co"># preprocess raw correlated dataset; don't group negatively correlated features</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">corr_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">collapse_corr_feats</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   outcome var1_yes var2_1 var3_1</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0      0      1</span>
<span class="co">#&gt; 2 normal         1      1      0</span>
<span class="co">#&gt; 3 cancer         0      0      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>In this case, <code>grp_feats</code> will always be <code>NULL</code>.</p>
</div>
<div id="data-with-near-zero-variance" class="section level2">
<h2 class="hasAnchor">
<a href="#data-with-near-zero-variance" class="anchor"></a>Data with near-zero variance</h2>
<p>What if we have variables that are all zero, or all “no”? Those ones won’t contribute any information, so we remove them:</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="co"># raw dataset with non-variable features</span>
<span class="no">nonvar_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>),
  <span class="kw">var3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>,<span class="st">"no"</span>,<span class="st">"no"</span>),
  <span class="kw">var4</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">0</span>),
  <span class="kw">var5</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">12</span>,<span class="fl">12</span>,<span class="fl">12</span>)
)
<span class="no">nonvar_df</span>
<span class="co">#&gt;   outcome var1 var2 var3 var4 var5</span>
<span class="co">#&gt; 1  normal   no    0   no    0   12</span>
<span class="co">#&gt; 2  normal  yes    1   no    0   12</span>
<span class="co">#&gt; 3  cancer   no    1   no    0   12</span></pre></body></html></div>
<p>Here, <code>var3</code>, <code>var4</code>, and <code>var5</code> all have no variability, so these variables are removed during preprocessing:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="co"># remove features with near-zero variance</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">nonvar_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   outcome var1_yes var2_1</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0      0</span>
<span class="co">#&gt; 2 normal         1      1</span>
<span class="co">#&gt; 3 cancer         0      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>You can read the <a href="https://www.rdocumentation.org/packages/caret/versions/6.0-86/topics/preProcess"><code><a href="https://rdrr.io/pkg/caret/man/preProcess.html">caret::preProcess</a></code></a> documentation for more information. If you want to include them, you can use the argument <code>remove_nzv=FALSE</code>. For this to work, you cannot collapse correlated features (otherwise it errors out because of the underlying <code>caret</code> function we use).</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="co"># don't remove features with near-zero variance</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">nonvar_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">remove_nzv</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">collapse_corr_feats</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 6</span>
<span class="co">#&gt;   outcome var1_yes var2_1  var3  var4  var5</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0      0     0     0    12</span>
<span class="co">#&gt; 2 normal         1      1     0     0    12</span>
<span class="co">#&gt; 3 cancer         0      1     0     0    12</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>Note that if you want to remove zero variance features (rather than near-zero variance features), you can use <code>method = c('zv')</code>, and then you can collapse correlated features:</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="co"># remove features with zero variance</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">nonvar_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">'zv'</span>))
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   outcome var1_yes var2_1</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0      0</span>
<span class="co">#&gt; 2 normal         1      1</span>
<span class="co">#&gt; 3 cancer         0      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
</div>
<div id="missing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#missing-data" class="anchor"></a>Missing data</h2>
<p>The <code>preprocess_data</code> function also deals with missing data. It:</p>
<ul>
<li>Removes missing outcome variables.</li>
<li>Maintains zero variability in a feature if it already has no variability (i.e. the feature is removed if removing features with near-zero variance).</li>
<li>Replaces missing binary and categorical variables with zero (after splitting into multiple columns).</li>
<li>Replaces missing continuous data with the median value of that feature.</li>
</ul>
<p>If you’d like to deal with missing data in a different way, please do that prior to inputting the data into the <code>preprocess_data</code> function.</p>
<div id="remove-missing-outcome-variables" class="section level3">
<h3 class="hasAnchor">
<a href="#remove-missing-outcome-variables" class="anchor"></a>Remove missing outcome variables</h3>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="co"># raw dataset with missing outcome value</span>
<span class="no">miss_oc_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>,<span class="fl">NA</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>,<span class="st">"no"</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>,<span class="fl">1</span>)
)
<span class="no">miss_oc_df</span>
<span class="co">#&gt;   outcome var1 var2</span>
<span class="co">#&gt; 1  normal   no    0</span>
<span class="co">#&gt; 2  normal  yes    1</span>
<span class="co">#&gt; 3  cancer   no    1</span>
<span class="co">#&gt; 4    &lt;NA&gt;   no    1</span></pre></body></html></div>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="co"># preprocess raw dataset with missing outcome value</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">miss_oc_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; Removed 1/4 (25%) of samples because of missing outcome value (NA).</span>
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   outcome var1_yes var2_1</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;  &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0      0</span>
<span class="co">#&gt; 2 normal         1      1</span>
<span class="co">#&gt; 3 cancer         0      1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
</div>
<div id="maintain-zero-variability-in-a-feature-if-it-already-has-no-variability" class="section level3">
<h3 class="hasAnchor">
<a href="#maintain-zero-variability-in-a-feature-if-it-already-has-no-variability" class="anchor"></a>Maintain zero variability in a feature if it already has no variability</h3>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="co"># raw dataset with missing value in non-variable feature</span>
<span class="no">miss_nonvar_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="fl">1</span>, <span class="fl">1</span>)
)
<span class="no">miss_nonvar_df</span>
<span class="co">#&gt;   outcome var1 var2</span>
<span class="co">#&gt; 1  normal   no   NA</span>
<span class="co">#&gt; 2  normal  yes    1</span>
<span class="co">#&gt; 3  cancer   no    1</span></pre></body></html></div>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="co"># preprocess raw dataset with missing value in non-variable feature</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">miss_nonvar_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; There are 1 missing value(s) in features with no variation. Missing values were replaced with the non-varying value.</span>
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 2</span>
<span class="co">#&gt;   outcome var1_yes</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0</span>
<span class="co">#&gt; 2 normal         1</span>
<span class="co">#&gt; 3 cancer         0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
<p>Here, the non-variable feature with missing data is removed because we removed features with near-zero variance. If we maintained that feature, it’d be all ones:</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="co"># preprocess raw dataset with missing value in non-variable feature</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">miss_nonvar_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">remove_nzv</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">collapse_corr_feats</span> <span class="kw">=</span> <span class="fl">FALSE</span>)
<span class="co">#&gt; There are 1 missing value(s) in features with no variation. Missing values were replaced with the non-varying value.</span>
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 3</span>
<span class="co">#&gt;   outcome var1_yes  var2</span>
<span class="co">#&gt;   &lt;chr&gt;      &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal         0     1</span>
<span class="co">#&gt; 2 normal         1     1</span>
<span class="co">#&gt; 3 cancer         0     1</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
</div>
<div id="replace-missing-binary-and-categorical-variables-with-zero" class="section level3">
<h3 class="hasAnchor">
<a href="#replace-missing-binary-and-categorical-variables-with-zero" class="anchor"></a>Replace missing binary and categorical variables with zero</h3>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="co"># raw dataset with missing value in categorical feature</span>
<span class="no">miss_cat_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="fl">NA</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="fl">1</span>, <span class="fl">0</span>)
)
<span class="no">miss_cat_df</span>
<span class="co">#&gt;   outcome var1 var2</span>
<span class="co">#&gt; 1  normal   no   NA</span>
<span class="co">#&gt; 2  normal  yes    1</span>
<span class="co">#&gt; 3  cancer &lt;NA&gt;    0</span></pre></body></html></div>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="co"># preprocess raw dataset with missing value in non-variable feature</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">miss_cat_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; 4 categorical missing value(s) (NA) were replaced with 0. Note that the matrix is not full rank so missing values may be duplicated in separate columns.</span>
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 4</span>
<span class="co">#&gt;   outcome var1_no var2_0  grp1</span>
<span class="co">#&gt;   &lt;chr&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal        1      0     0</span>
<span class="co">#&gt; 2 normal        0      0     1</span>
<span class="co">#&gt; 3 cancer        0      1     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; $grp_feats$var1_no</span>
<span class="co">#&gt; [1] "var1_no"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$var2_0</span>
<span class="co">#&gt; [1] "var2_0"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$grp1</span>
<span class="co">#&gt; [1] "var2_1"   "var1_yes"</span></pre></body></html></div>
<p>Here each binary variable is split into two, and the missing value is considered zero for both of them.</p>
</div>
<div id="replace-missing-continuous-data-with-the-median-value-of-that-feature" class="section level3">
<h3 class="hasAnchor">
<a href="#replace-missing-continuous-data-with-the-median-value-of-that-feature" class="anchor"></a>Replace missing continuous data with the median value of that feature</h3>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="co"># raw dataset with missing value in continuous feature</span>
<span class="no">miss_cont_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>,<span class="st">"normal"</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">2</span>,<span class="fl">NA</span>),
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">NA</span>)
)
<span class="no">miss_cont_df</span>
<span class="co">#&gt;   outcome var1 var2</span>
<span class="co">#&gt; 1  normal    1    1</span>
<span class="co">#&gt; 2  normal    2    2</span>
<span class="co">#&gt; 3  cancer    2    3</span>
<span class="co">#&gt; 4  normal   NA   NA</span></pre></body></html></div>
<p>Here we’re not normalizing continuous features so it’s easier to see what’s going on (i.e. the median value is used):</p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="co"># preprocess raw dataset with missing value in continuous feature</span>
<span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">miss_cont_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="kw">NULL</span>)
<span class="co">#&gt; 2 missing continuous value(s) were imputed using the median value of the feature.</span>
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 4 x 3</span>
<span class="co">#&gt;   outcome  var1  var2</span>
<span class="co">#&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal      1     1</span>
<span class="co">#&gt; 2 normal      2     2</span>
<span class="co">#&gt; 3 cancer      2     3</span>
<span class="co">#&gt; 4 normal      2     2</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; NULL</span></pre></body></html></div>
</div>
</div>
<div id="putting-it-all-together" class="section level2">
<h2 class="hasAnchor">
<a href="#putting-it-all-together" class="anchor"></a>Putting it all together</h2>
<p>Here’s some more complicated example raw data that puts everything we discussed together:</p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">test_df</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(
  <span class="kw">outcome</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"normal"</span>, <span class="st">"normal"</span>, <span class="st">"cancer"</span>, <span class="fl">NA</span>),
  <span class="kw">var1</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">4</span>,
  <span class="kw">var2</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"c"</span>, <span class="st">"d"</span>),
  <span class="kw">var3</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"yes"</span>, <span class="st">"no"</span>, <span class="st">"no"</span>),
  <span class="kw">var4</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>),
  <span class="kw">var5</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>),
  <span class="kw">var6</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"no"</span>, <span class="st">"no"</span>, <span class="st">"no"</span>, <span class="st">"no"</span>),
  <span class="kw">var7</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>),
  <span class="kw">var8</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">NA</span>, <span class="fl">7</span>),
  <span class="kw">var9</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">NA</span>, <span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"z"</span>),
  <span class="kw">var10</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">NA</span>, <span class="fl">NA</span>),
  <span class="kw">var11</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">NA</span>, <span class="fl">NA</span>),
  <span class="kw">var12</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span>, <span class="st">"4"</span>)
)
<span class="no">test_df</span>
<span class="co">#&gt;   outcome var1 var2 var3 var4 var5 var6 var7 var8 var9 var10 var11 var12</span>
<span class="co">#&gt; 1  normal    1    a   no    0    0   no    1    5 &lt;NA&gt;     1     1     1</span>
<span class="co">#&gt; 2  normal    2    b  yes    1    0   no    1    6    x     0     1     2</span>
<span class="co">#&gt; 3  cancer    3    c   no    0    0   no    0   NA    y    NA    NA     3</span>
<span class="co">#&gt; 4    &lt;NA&gt;    4    d   no    0    0   no    0    7    z    NA    NA     4</span></pre></body></html></div>
<p>Let’s throw this into the preprocessing function with the default values:</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="../reference/preprocess_data.html">preprocess_data</a></span>(<span class="kw">dataset</span> <span class="kw">=</span> <span class="no">test_df</span>, <span class="kw">outcome_colname</span> <span class="kw">=</span> <span class="st">"outcome"</span>)
<span class="co">#&gt; Removed 1/4 (25%) of samples because of missing outcome value (NA).</span>
<span class="co">#&gt; There are 1 missing value(s) in features with no variation. Missing values were replaced with the non-varying value.</span>
<span class="co">#&gt; 4 categorical missing value(s) (NA) were replaced with 0. Note that the matrix is not full rank so missing values may be duplicated in separate columns.</span>
<span class="co">#&gt; 1 missing continuous value(s) were imputed using the median value of the feature.</span>
<span class="co">#&gt; $dat_transformed</span>
<span class="co">#&gt; # A tibble: 3 x 6</span>
<span class="co">#&gt;   outcome   var8  grp1  grp2  grp3  grp4</span>
<span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span>
<span class="co">#&gt; 1 normal  -0.707    -1     0     0     1</span>
<span class="co">#&gt; 2 normal   0.707     0     1     0     0</span>
<span class="co">#&gt; 3 cancer   0         1     0     1     0</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats</span>
<span class="co">#&gt; $grp_feats$var8</span>
<span class="co">#&gt; [1] "var8"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$grp1</span>
<span class="co">#&gt; [1] "var12" "var1" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$grp2</span>
<span class="co">#&gt; [1] "var4_1"   "var3_yes" "var2_b"   "var9_x"   "var10_0" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$grp3</span>
<span class="co">#&gt; [1] "var2_c" "var7_1" "var9_y"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $grp_feats$grp4</span>
<span class="co">#&gt; [1] "var10_1" "var2_a"</span></pre></body></html></div>
<p>As you can see, we got several messages:</p>
<ul>
<li>One of the samples (row 4) was removed because the outcome value was missing.</li>
<li>One of the variables in a feature with no variation had a missing value that was replaced with the the non-varying value (<code>var11</code>).</li>
<li>Four categorical missing values were replaced with zero (<code>var9</code>). There are 4 missing rather than just 1 (like in the raw data) because we split the categorical variable into 4 different columns first.</li>
<li>One missing continuous value was imputed using the median value of that feature (<code>var8</code>).</li>
</ul>
<p>Additionally, you can see that the continuous variables were normalized, the categorical variables were all changed to binary, and several features were grouped together. The variables in each group can be found in <code>grp_feats</code>.</p>
</div>
<div id="next-step-run-machine-learning" class="section level2">
<h2 class="hasAnchor">
<a href="#next-step-run-machine-learning" class="anchor"></a>Next step: run machine learning!</h2>
<p>After you preprocess your data (either using the <code>preprocess_data</code> function or by preprocessing the data on your own), you’re ready to run machine learning! Please see the vignette on the <code>run_ml</code> function for more information about running machine learning.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Begüm Topçuoğlu, Patrick Schloss, Zena Lapp, Kelly Sovacool.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
